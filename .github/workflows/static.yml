# Simple workflow for deploying static content to GitHub Pages
name: Deploy static content to Pages

on:
  push:
    branches: ["main"]

  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Pages
        uses: actions/configure-pages@v5

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: './website/'

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4

      - name: Send WhatsApp message via CallMeBot
        run: |
          curl -X GET "https://api.callmebot.com/whatsapp.php?phone=${{ secrets.CALLMEBOT_PHONE }}&text=%F0%9F%93%A2+Oak+Store+Web+Atualizada%21%0A%0A%F0%9F%9A%80+Confira+as+%C3%BAltimas+melhorias+e+atualiza%C3%A7%C3%B5es+diretamente+na+nossa+plataforma.%0AAcesse+o+link+abaixo+para+explorar+a+nova+vers%C3%A3o%3A%0A%0A%F0%9F%94%97+https%3A%2F%2Fgampiot-inc.github.io%2FOak-Store-Web%0A%0A%F0%9F%93%82+Reposit%C3%B3rio%3A+${{ github.repository }}&apikey=${{ secrets.CALLMEBOT_API_KEY }}"

      - name: Debug WhatsApp
        run: echo "Sending message to WhatsApp..."
